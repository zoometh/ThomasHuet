yref = "y",
x = 16,
y = 6,
sizex = 8,
sizey = 8,
# sizing = "stretch",
opacity = 1,
layer = "below"
)
)
)
xy.size <- 6
plot_ly(finePots, x = ~OxfordPct, y = ~NewForestPct, text = labels,
type = 'scatter', mode = 'markers') %>%
add_text(textfont = t, textposition = 'middle right') %>%
layout(title = paste0('Ratio of Oxford pottery/New Forest pottery for ', nrow(finePots),' Late Roman sites'),
xaxis = list(title = "% Oxford pottery"),
yaxis = list(title = "% New Forest pottery"),
images = list(
list(
source =  paste('data:image/jpg;base64', NewForP.txt, sep=','),
xref = "x",
yref = "y",
x = 12,
y = 16,
sizex = xy.size,
sizey = xy.size,
# sizing = "stretch",
opacity = 1,
layer = "below"
),
list(
source =  paste('data:image/jpg;base64', OxfordP.txt, sep=','),
xref = "x",
yref = "y",
x = 16,
y = 6,
sizex = xy.size,
sizey = xy.size,
# sizing = "stretch",
opacity = 1,
layer = "below"
)
)
)
library(plotly)
library(archdata)
data(OxfordPots)
finePots <- OxfordPots[!is.na(OxfordPots$OxfordPct) & !is.na(OxfordPots$NewForestPct), ]
labels <- paste0(" ", rownames(finePots), ". ", finePots$Place)
t <- list(
family = "sans serif",
size = 14,
color = "blue")
m <- list(
l = 200,
r = 50,
b = 100,
t = 100,
pad = 20
)
xy.size <- 6
OxfordP <- "C:/Rprojects/thomashuet/teachings/stats/UPV/images/art-pottery-oxford.jpg"
NewForP <- "C:/Rprojects/thomashuet/teachings/stats/UPV/images/art-pottery-newforest.jpg"
OxfordP.txt <- RCurl::base64Encode(readBin(OxfordP, "raw", file.info(OxfordP)[1, "size"]), "txt")
NewForP.txt <- RCurl::base64Encode(readBin(NewForP, "raw", file.info(NewForP)[1, "size"]), "txt")
plot_ly(finePots, x = ~OxfordPct, y = ~NewForestPct, text = labels,
type = 'scatter', mode = 'markers',
width = 1000, height = 600, margin = m) %>%
add_text(textfont = t, textposition = 'middle right') %>%
layout(title = paste0('Ratio Oxford pottery/New Forest pottery for ', nrow(finePots),
' Late Roman sites'),
xaxis = list(title = "% Oxford pottery"),
yaxis = list(title = "% New Forest pottery"),
images = list(
list(
source =  paste('data:image/jpg;base64', NewForP.txt, sep=','),
xref = "x",
yref = "y",
x = 12,
y = 18,
sizex = xy.size,
sizey = xy.size,
# sizing = "stretch",
opacity = 1,
layer = "below"
),
list(
source =  paste('data:image/jpg;base64', OxfordP.txt, sep=','),
xref = "x",
yref = "y",
x = 16,
y = 6,
sizex = xy.size,
sizey = xy.size,
# sizing = "stretch",
opacity = 1,
layer = "below"
)
)
)
library(plotly)
library(archdata)
data(OxfordPots)
finePots <- OxfordPots[!is.na(OxfordPots$OxfordPct) & !is.na(OxfordPots$NewForestPct), ]
labels <- paste0(" ", rownames(finePots), ". ", finePots$Place)
t <- list(
family = "sans serif",
size = 14,
color = "blue")
m <- list(
l = 200,
r = 50,
b = 100,
t = 100,
pad = 20
)
xy.size <- 6
OxfordP <- "C:/Rprojects/thomashuet/teachings/stats/UPV/images/art-pottery-oxford.jpg"
NewForP <- "C:/Rprojects/thomashuet/teachings/stats/UPV/images/art-pottery-newforest.jpg"
OxfordP.txt <- RCurl::base64Encode(readBin(OxfordP, "raw", file.info(OxfordP)[1, "size"]), "txt")
NewForP.txt <- RCurl::base64Encode(readBin(NewForP, "raw", file.info(NewForP)[1, "size"]), "txt")
plot_ly(finePots, x = ~OxfordPct, y = ~NewForestPct, text = labels,
type = 'scatter', mode = 'markers',
width = 1000, height = 600, margin = m) %>%
add_text(textfont = t, textposition = 'middle right') %>%
layout(title = paste0('Ratio Oxford pottery/New Forest pottery for ', nrow(finePots),
' Late Roman sites'),
xaxis = list(title = "% Oxford pottery", showgrid = FALSE),
yaxis = list(title = "% New Forest pottery", showgrid = FALSE),
images = list(
list(
source =  paste('data:image/jpg;base64', NewForP.txt, sep=','),
xref = "x",
yref = "y",
x = 12,
y = 18,
sizex = xy.size,
sizey = xy.size,
# sizing = "stretch",
opacity = 1,
layer = "below"
),
list(
source =  paste('data:image/jpg;base64', OxfordP.txt, sep=','),
xref = "x",
yref = "y",
x = 16,
y = 6,
sizex = xy.size,
sizey = xy.size,
# sizing = "stretch",
opacity = 1,
layer = "below"
)
)
)
#| echo: false
data("Mesolithic")
Mesolithic.pers <- round(Mesolithic/rowSums(Mesolithic)*100, 1)
datatable(Mesolithic.pers, caption = "British Mesolithic assemblages (%)") %>%
formatStyle(
colnames(Mesolithic.pers),
background = styleColorBar(Mesolithic.pers$Microliths, 'lightblue'),
backgroundSize = '100% 90%',
backgroundRepeat = 'no-repeat',
backgroundPosition = 'center'
)
library(plotly)
library(archdata)
data(OxfordPots)
finePots <- OxfordPots[!is.na(OxfordPots$OxfordPct) & !is.na(OxfordPots$NewForestPct), ]
labels <- paste0(" ", rownames(finePots), ". ", finePots$Place)
t <- list(
family = "sans serif",
size = 14,
color = "blue")
xy.size <- 6
OxfordP <- "C:/Rprojects/thomashuet/teachings/stats/UPV/images/art-pottery-oxford.jpg"
NewForP <- "C:/Rprojects/thomashuet/teachings/stats/UPV/images/art-pottery-newforest.jpg"
OxfordP.txt <- RCurl::base64Encode(readBin(OxfordP, "raw", file.info(OxfordP)[1, "size"]), "txt")
NewForP.txt <- RCurl::base64Encode(readBin(NewForP, "raw", file.info(NewForP)[1, "size"]), "txt")
plot_ly(finePots, x = ~OxfordPct, y = ~NewForestPct, text = labels,
type = 'scatter', mode = 'markers',
width = 1000, height = 600) %>%
add_text(textfont = t, textposition = 'middle right') %>%
layout(title = paste0('Ratio Oxford pottery/New Forest pottery for ', nrow(finePots),
' Late Roman sites'),
xaxis = list(title = "% Oxford pottery", showgrid = FALSE),
yaxis = list(title = "% New Forest pottery", showgrid = FALSE),
images = list(
list(
source =  paste('data:image/jpg;base64', NewForP.txt, sep=','),
xref = "x",
yref = "y",
x = 12,
y = 18,
sizex = xy.size,
sizey = xy.size,
# sizing = "stretch",
opacity = 1,
layer = "below"
),
list(
source =  paste('data:image/jpg;base64', OxfordP.txt, sep=','),
xref = "x",
yref = "y",
x = 16,
y = 6,
sizex = xy.size,
sizey = xy.size,
# sizing = "stretch",
opacity = 1,
layer = "below"
)
)
)
sites <- openxlsx::read.xlsx("C:/Users/Thomas Huet/Desktop/a classer/jews_ari.xlsx")
sites <- openxlsx::read.xlsx("C:/Users/Thomas Huet/Desktop/a classer/jews_ari.xlsx")
buff <- .02
bbox <- c(left = min(sites$x)-buff,
bottom = min(sites$y)-buff,
right = max(sites$x)+buff,
top = max(sites$y)+buff)
stamenbck <- ggmap::ggmap(get_stamenmap(bbox, maptype = "terrain-background"))
library(ggmap)
stamenbck <- ggmap(get_stamenmap(bbox, maptype = "terrain-background"))
ggplot() +
geom_sf(data = stamenbck) +
geom_sf(data = sites, aes(x = x, y = y), fill = 'red') +
theme_bw()
library(ggmap)
library(ggplot2)
library(sp)
sites <- openxlsx::read.xlsx("C:/Users/Thomas Huet/Desktop/a classer/jews_ari.xlsx")
wgs84 <- "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
xy <- sites[ , c("x", "y")]
spat_df <- SpatialPointsDataFrame(coords = xy,
data = sites,
proj4string= CRS(wgs84))
library(sf)
sites.sf <- st_as_sf(spat_df)
ggplot() +
geom_sf(data = stamenbck) +
geom_sf(sites.sf, fill = 'red') +
theme_bw()
rlang::last_error()
plot(sites.sf)
ggplot() +
geom_sf(data = stamenbck) +
geom_sf(sites.sf, fill = 'red',inherit.aes = FALSE) +
theme_bw()
ggplot() +
geom_sf(data = stamenbck)
ggplot2::ggplot() +
geom_sf(data = stamenbck) +
geom_sf(sites.sf, fill = 'red',inherit.aes = FALSE) +
theme_bw()
ggplot2::ggplot() +
# geom_sf(data = stamenbck) +
geom_sf(sites.sf, fill = 'red',inherit.aes = FALSE) +
theme_bw()
ggplot2::ggplot() +
# geom_sf(data = stamenbck) +
geom_sf(sites.sf) +
theme_bw()
rlang::last_error()
?geom_sf
ggplot2::ggplot(sites.sf) +
geom_sf(data = stamenbck) +
geom_sf()
ggplot2::ggplot(sites.sf) +
geom_sf()
ggplot2::ggplot(stamenbck) +
geom_sf(sites.sf) +
theme_bw()
ggmap::ggmap(stamenbck) +
geom_sf(sites.sf) +
theme_bw()
ggmap::ggmap(stamenbck) +
ggplot2::geom_sf(sites.sf, inherit.aes = FALSE)
stamenbck <- ggmap::get_stamenmap(bbox,
zoom = 8,
maptype = "terrain-background")
ggmap::ggmap(stamenbck) +
ggplot2::geom_sf(sites.sf, inherit.aes = FALSE) +
theme_bw()
ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, fill = 'red',
inherit.aes = FALSE)
buff <- .05
bbox <- c(left = min(sites$x)-buff,
bottom = min(sites$y)-buff,
right = max(sites$x)+buff,
top = max(sites$y)+buff)
stamenbck <- ggmap::get_stamenmap(bbox,
zoom = 8,
maptype = "terrain-background")
ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, fill = 'red',
inherit.aes = FALSE)
buff <- .1
bbox <- c(left = min(sites$x)-buff,
bottom = min(sites$y)-buff,
right = max(sites$x)+buff,
top = max(sites$y)+buff)
stamenbck <- ggmap::get_stamenmap(bbox,
zoom = 8,
maptype = "terrain-background")
ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, fill = 'red',
inherit.aes = FALSE)
ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, text = sites))
ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, labels = sites))
ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = sites))
ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = rownames(sites)))
library(ggmap)
library(ggplot2)
library(sp)
library(sf)
sites <- openxlsx::read.xlsx("C:/Users/Thomas Huet/Desktop/a classer/jews_ari.xlsx")
wgs84 <- "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
xy <- sites[ , c("x", "y")]
spat_df <- SpatialPointsDataFrame(coords = xy,
data = sites,
proj4string= CRS(wgs84))
sites.sf <- st_as_sf(spat_df)
buff <- .1
bbox <- c(left = min(sites$x)-buff,
bottom = min(sites$y)-buff,
right = max(sites$x)+buff,
top = max(sites$y)+buff)
stamenbck <- ggmap::get_stamenmap(bbox,
zoom = 8,
maptype = "terrain-background")
map <- ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
map
library(ggmap)
library(ggplot2)
library(sp)
library(sf)
sites <- openxlsx::read.xlsx("C:/Users/Thomas Huet/Desktop/a classer/jews_ari.xlsx")
wgs84 <- "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
xy <- sites[ , c("x", "y")]
spat_df <- SpatialPointsDataFrame(coords = xy,
data = sites,
proj4string= CRS(wgs84))
sites.sf <- st_as_sf(spat_df)
buff <- .1
bbox <- c(left = min(sites$x)-buff,
bottom = min(sites$y)-buff,
right = max(sites$x)+buff,
top = max(sites$y)+buff)
stamenbck <- ggmap::get_stamenmap(bbox,
zoom = 8,
maptype = "terrain-background")
map <- ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
map
library(ggmap)
library(ggplot2)
library(sp)
library(sf)
sites <- openxlsx::read.xlsx("C:/Users/Thomas Huet/Desktop/a classer/jews_ari.xlsx")
wgs84 <- "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
xy <- sites[ , c("x", "y")]
spat_df <- SpatialPointsDataFrame(coords = xy,
data = sites,
proj4string= CRS(wgs84))
sites.sf <- st_as_sf(spat_df)
buff <- .1
bbox <- c(left = min(sites$x)-buff,
bottom = min(sites$y)-buff,
right = max(sites$x)+buff,
top = max(sites$y)+buff)
stamenbck <- ggmap::get_stamenmap(bbox,
zoom = 8,
maptype = "terrain-background")
map <- ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
map
library(ggmap)
library(ggplot2)
library(sp)
library(sf)
sites <- openxlsx::read.xlsx("C:/Users/Thomas Huet/Desktop/a classer/jews_ari.xlsx")
wgs84 <- "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
xy <- sites[ , c("x", "y")]
spat_df <- SpatialPointsDataFr
library(ggmap)
library(ggplot2)
library(sp)
library(sf)
sites <- openxlsx::read.xlsx("C:/Users/Thomas Huet/Desktop/a classer/jews_ari.xlsx")
wgs84 <- "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
xy <- sites[ , c("x", "y")]
spat_df <- SpatialPointsDataFrame(coords = xy,
data = sites,
proj4string= CRS(wgs84))
sites.sf <- st_as_sf(spat_df)
sites <- openxlsx::read.xlsx("C:/Users/Thomas Huet/Desktop/a classer/jews_ari.xlsx")
sites
library(ggmap)
library(ggplot2)
library(sp)
library(sf)
sites <- openxlsx::read.xlsx("C:/Users/Thomas Huet/Desktop/a classer/jews_ari.xlsx")
wgs84 <- "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
xy <- sites[ , c("x", "y")]
spat_df <- SpatialPointsDataFrame(coords = xy,
data = sites,
proj4string= CRS(wgs84))
sites.sf <- st_as_sf(spat_df)
buff <- .1
bbox <- c(left = min(sites$x)-buff,
bottom = min(sites$y)-buff,
right = max(sites$x)+buff,
top = max(sites$y)+buff)
stamenbck <- ggmap::get_stamenmap(bbox,
zoom = 8,
maptype = "terrain-background")
map <- ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
map
map
?ggmap
?get_stamenmap
stamenbck <- ggmap::get_stamenmap(bbox, alpha = .5,
zoom = 8,
maptype = "terrain-background")
map <- ggmap::ggmap(stamenbck) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
map
map
map <- ggmap::ggmap(stamenbck, alpha = .5) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
map
map <- ggmap::ggmap(stamenbck, darken = 1) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
map
map <- ggmap::ggmap(stamenbck, darken = c(0.6, "white")) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
map
map <- ggmap::ggmap(stamenbck, darken = c(0.8, "white")) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
map
map <- ggmap::ggmap(stamenbck, darken = c(0.2, "white")) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
map
buff <- 1
bbox <- c(left = min(sites$x)-buff,
bottom = min(sites$y)-buff,
right = max(sites$x)+buff,
top = max(sites$y)+buff)
stamenbck <- ggmap::get_stamenmap(bbox,
zoom = 8,
maptype = "terrain-background")
map <- ggmap::ggmap(stamenbck, darken = c(0.2, "white")) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
map
map <- ggmap::ggmap(stamenbck, darken = c(0.2, "white")) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion)) +
ggsn::scalebar(x.min = 144.5, x.max = 147.5,
y.min = 13.5, y.max = 16.5,
dist = 50, dd2km = TRUE, model = 'WGS84')
map
library(ggsn)
map <- ggmap::ggmap(stamenbck, darken = c(0.2, "white")) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion)) +
my_scalebar(x.min = 144.5, x.max = 147.5,
y.min = 13.5,  y.max = 16.5,
dist = 50, dd2km = TRUE, model = 'WGS84',
box.fill = c("yellow", "white"), st.color = "white")
map
map <- ggmap::ggmap(stamenbck, darken = c(0.2, "white")) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion)) +
ggsn::scalebar(x.min = 144.5, x.max = 147.5,
y.min = 13.5, y.max = 16.5,
dist = 50, dd2km = TRUE, model = 'WGS84')
map
map <- ggmap::ggmap(stamenbck, darken = c(0.2, "white")) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
ggsave(map, "C:/Users/Thomas Huet/Desktop/a classer/jews_ari.svg")
map <- ggmap::ggmap(stamenbck, darken = c(0.2, "white")) +
ggplot2:: geom_sf(data = sites.sf, inherit.aes = FALSE) +
ggrepel::geom_text_repel(data = sites.sf, aes(x = x, y = y, label = num, color = Religion))
ggsave(map, "C:/Users/Thomas Huet/Desktop/a classer/jews_ari.svg")
ggsave(map, filename =  "C:/Users/Thomas Huet/Desktop/a classer/jews_ari.svg", device = "svg")
