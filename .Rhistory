ggplot(Molten, aes(x = variable, y = value, colour = patient, group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), hjust = .5) +
geom_path()
df.copy3.melted <- melt(df.copy3, id.vars = "patient")
ggplot(Molten, aes(x = variable, y = value, colour = patient, group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), hjust = 0) +
geom_path()
df.copy3.melted <- melt(df.copy3, id.vars = "patient")
ggplot(Molten, aes(x = variable, y = value, colour = patient, group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), vjust = 0) +
geom_path()
df.copy3.melted <- melt(df.copy3, id.vars = "patient")
ggplot(Molten, aes(x = variable, y = value, colour = patient, group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), vjust = 0.5) +
geom_path()
df.copy3.melted <- melt(df.copy3, id.vars = "patient")
ggplot(Molten, aes(x = variable, y = value, colour = patient, group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), vjust = 1) +
geom_path()
df.copy4 <- melt(df.copy3, id.vars = "patient")
ggplot(df.copy4, aes(x = variable, y = value,
group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), vjust = 1) +
geom_path() +
theme_bw()
df.copy4 <- melt(df.copy3, id.vars = "patient")
ggplot(df.copy4, aes(x = variable, y = value,
colour = patient,
group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), vjust = 1) +
geom_path() +
theme_bw()
chisq <- chisq.test(df)
chisq <- chisq.test(df[ , -1])
round(chisq$expected,2)
chisq$observed
round(chisq$residuals, 3)
#| echo: true
#| code-fold: true
df.copy3 <- df.copy2
for(i in seq(1, nrow(df))){
for(j in seq(2, ncol(df))){
obs.val <- df[i, j]
exp.val <- df.copy2[ i, j]
khi.val <- (obs.val-exp.val)**2 / exp.val
df.copy3[i, j] <- khi.val
}
}
df.copy3
round(chisq$residuals, 3)
# df.copy4 <- melt(df.copy3, id.vars = "patient")
df.copy4 <- melt(chisq$residuals, id.vars = "patient")
ggplot(df.copy4, aes(x = variable, y = value,
colour = patient,
group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), vjust = 1) +
geom_path() +
theme_bw()
chisq$residuals
# df.copy4 <- melt(df.copy3, id.vars = "patient")
df.copy4 <- chisq$residuals
rownames(df.copy4) <- df$patient
# df.copy4 <- melt(df.copy3, id.vars = "patient")
df.copy4 <- chisq$residuals
df.copy4$patient <- df$patient
df.copy4 <- melt(chisq$residuals, id.vars = "patient")
ggplot(df.copy4, aes(x = variable, y = value,
colour = patient,
group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), vjust = 1) +
geom_path() +
theme_bw()
df.copy4 <- chisq$residuals
df.copy4$patient <- df$patient
df.copy4 <- melt(chisq$residuals, id.vars = "patient")
df.copy4
df.copy4 <- chisq$residuals
df.copy4$patient <- df$patient
df.copy4
# df.copy4 <- melt(df.copy3, id.vars = "patient")
df.copy4 <- as.data.frame(chisq$residuals)
# df.copy4 <- melt(df.copy3, id.vars = "patient")
df.copy4 <- as.data.frame(chisq$residuals)
df.copy4$patient <- df$patient
df.copy4 <- melt(chisq$residuals, id.vars = "patient")
ggplot(df.copy4, aes(x = variable, y = value,
colour = patient,
group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), vjust = 1) +
geom_path() +
theme_bw()
df.copy4 <- as.data.frame(chisq$residuals)
df.copy4$patient <- df$patient
df.copy4
# df.copy4 <- melt(df.copy3, id.vars = "patient")
df.copy4 <- as.data.frame(chisq$residuals)
df.copy4$patient <- df$patient
df.copy4 <- melt(df.copy4, id.vars = "patient")
ggplot(df.copy4, aes(x = variable, y = value,
colour = patient,
group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), vjust = 1) +
geom_path() +
theme_bw()
df.copy3 <- as.data.frame(chisq$residuals)
df.copy3
#| echo: true
#| code-fold: true
library(dplyr)
library(tibble)
df <- data.frame(patient = c("Mal.1", "Mal.2", "Mal.3"),
virus.A = c(12, 18, 14),
virus.B = c(7, 7, 10),
virus.C = c(11, 5, 6))
df
#| echo: true
#| code-fold: true
df.copy <- df
df.copy <- rbind(df.copy, colSums(df.copy[ , -1]))
df.copy[nrow(df.copy), "patient"] <- "col.sum"
df.copy <- cbind(df.copy, rowSums(df.copy[ , -1]))
colnames(df.copy)[ncol(df.copy)] <- "row.sum"
df.copy
#| echo: true
#| code-fold: true
chisq <- chisq.test(df[ , -1])
df.copy2 <- round(chisq$expected, 2)
# total <- df.copy[nrow(df.copy), ncol(df.copy)]
# df.copy2 <- df
# for(i in seq(1, nrow(df))){
#   for(j in seq(2, ncol(df))){
#     col.sum <- sum(df.copy2[ , j])
#     row.sum <- sum(df.copy2[ i, seq(2, ncol(df))])
#     obs.val <- df.copy2[i, j]
#     exp.val <- (col.sum * row.sum) / total
#     df.copy2[i, j] <- exp.val
#   }
# }
# df.copy2
#| echo: true
#| code-fold: true
chisq <- chisq.test(df[ , -1])
df.copy2 <- round(chisq$expected, 2)
df.copy2
# total <- df.copy[nrow(df.copy), ncol(df.copy)]
# df.copy2 <- df
# for(i in seq(1, nrow(df))){
#   for(j in seq(2, ncol(df))){
#     col.sum <- sum(df.copy2[ , j])
#     row.sum <- sum(df.copy2[ i, seq(2, ncol(df))])
#     obs.val <- df.copy2[i, j]
#     exp.val <- (col.sum * row.sum) / total
#     df.copy2[i, j] <- exp.val
#   }
# }
# df.copy2
#| echo: true
#| code-fold: true
df.copy3 <- as.data.frame(chisq$residuals)
df.copy3$patient <- df$patient
df.copy3
# df.copy3 <- df.copy2
# for(i in seq(1, nrow(df))){
#   for(j in seq(2, ncol(df))){
#     obs.val <- df[i, j]
#     exp.val <- df.copy2[ i, j]
#     khi.val <- (obs.val-exp.val)**2 / exp.val
#     df.copy3[i, j] <- khi.val
#   }
# }
# df.copy3
# df.copy4 <- melt(df.copy3, id.vars = "patient")
df.copy4 <- melt(df.copy3, id.vars = "patient")
ggplot(df.copy4, aes(x = variable, y = value,
colour = patient,
group = patient)) +
geom_point() +
geom_text(aes(label = round(value, 2)), vjust = 1) +
geom_path() +
theme_bw()
#| echo: true
#| code-fold: true
df %>%
melt() %>%
group_by(patient, variable) %>%
summarise(count = sum(value)) %>%
summarise(pvalue= chisq.test(count)$p.value)
#| echo: true
#| code-fold: true
df.copy <- df
df.copy <- rbind(df.copy, colSums(df.copy[ , -1]))
df.copy[nrow(df.copy), "patient"] <- "col.sum"
df.copy <- cbind(df.copy, rowSums(df.copy[ , -1]))
colnames(df.copy)[ncol(df.copy)] <- "row.sum"
kable(df.copy) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 20) %>%
column_spec(ncol(df.copy), bold = TRUE) %>%
row_spec(nrow(df.copy), bold = TRUE)
#| echo: true
#| code-fold: true
df.copy3 <- as.data.frame(chisq$residuals)
df.copy3$patient <- df$patient
kable(df.copy3) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 20)
#| echo: true
#| code-fold: true
chisq <- chisq.test(df[ , -1])
df.copy2 <- round(chisq$expected, 2)
df.copy2$patient <- df$patient
kable(df.copy2) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 20)
chisq <- chisq.test(df[ , -1])
df.copy2 <- round(chisq$expected, 2)
df.copy2
df.copy2 <- as.data.frame(round(chisq$expected, 2))
df.copy2
#| echo: true
#| code-fold: true
chisq <- chisq.test(df[ , -1])
df.copy2 <- as.data.frame(round(chisq$expected, 2))
df.copy2$patient <- df$patient
kable(df.copy2) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 20)
#| echo: true
#| code-fold: true
df.copy3 <- as.data.frame(round(chisq$residuals, 2))
df.copy3$patient <- df$patient
kable(df.copy3) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 20)
# df.copy4 <- melt(df.copy3, id.vars = "patient")
df.copy4 <- melt(df.copy3, id.vars = "patient")
ggplot(df.copy4, aes(x = variable, y = value,
colour = patient,
group = patient)) +
geom_point() +
geom_text(aes(label = value), vjust = 1) +
geom_path() +
theme_bw()
# df.copy4 <- melt(df.copy3, id.vars = "patient")
df.copy4 <- melt(df.copy3, id.vars = "patient")
ggplot(df.copy4, aes(x = variable, y = value,
colour = patient,
group = patient)) +
geom_hline(yintercept = 0) +
geom_point() +
geom_text(aes(label = value), vjust = 1) +
geom_path() +
theme_bw()
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"
df.khi2 <- df %>%
melt() %>%
group_by(patient, variable) %>%
summarise(count = sum(value)) %>%
summarise(pvalue= chisq.test(count)$p.value)
kable(df.khi2) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 24)
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"
df.khi2 <- df %>%
melt() %>%
group_by(patient, variable) %>%
summarise(count = sum(value)) %>%
summarise(pvalue= round(chisq.test(count)$p.value, 2))
kable(df.khi2) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 24)
chisq <- chisq.test(df[, c(2,3)])
chisq.test(df[, c(2,3)])
chisq.test(df[, c(2,4)])
chisq.test(df[, c(3, 4)])
chisq.test(df[, c(2, 3)])
chisq.test(df[, c(2, 4)])
chisq.test(df[, c(3, 4)])
df <- data.frame(patient = c("Mal.1", "Mal.2", "Mal.3"),
virus.A = c(12, 19, 13),
virus.B = c(7, 7, 10),
virus.C = c(11, 4, 5))
chisq.test(df[, c(2, 3)])
chisq.test(df[, c(2, 4)])
chisq.test(df[, c(3, 4)])
chisq.test(df[, c(3, 4)])$p.value
df$patient
matrix(nrow = lenght(df$patient),
ncol = lenght(df$patient)
matrix(nrow = lenght(df$patient),
ncol = lenght(df$patient))
matrix(nrow = length(df$patient),
ncol = length(df$patient))
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df
khi2.df[1 , 2] <- chisq.test(df[, c(2, 3)])$p.value
khi2.df
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
kable(khi2.df) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 24) %>%
column_spec(1, bold = TRUE)
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"
color.me <- which(df[, c(2, 4)] < .1)
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
kable(khi2.df) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 24) %>%
column_spec(1, bold = TRUE) %>%
row_spec(color.me, bold = T, color = "white", background = "red")
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"
color.me <- which(df[, c(2, 4)] < .1)
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
kable(khi2.df) %>%
kable(booktabs = T) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 24) %>%
column_spec(1, bold = TRUE) %>%
row_spec(color.me, bold = T, color = "white", background = "red")
color.me
df[, c(2, 4)]
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
color.me <- which(khi2.df[, c(2, 4)] < .1)
khi2.df
class(khi2.df)
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"
khi2.df <- as.data.frame(matrix(nrow = length(df$patient),
ncol = length(df$patient)))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
color.me <- which(khi2.df[, c(2, 4)] < .1)
khi2.df[, c(2, 4)]
khi2.df
khi2.df <- as.data.frame(matrix(nrow = length(df$patient),
ncol = length(df$patient)))
khi2.df
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[, c(2, 4)]
khi2.df
color.me <- which(khi2.df[] < .1)
color.me <- which(khi2.df < .1)
color.me
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
color.me <- which(khi2.df < .1)
kable(khi2.df) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 24) %>%
column_spec(1, bold = TRUE) %>%
row_spec(color.me, bold = T, color = "white", background = "red")
khi2.df <- as.data.frame(khi2.df)
khi2.df
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df <- as.data.frame(khi2.df)
khi2.df
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df
as.data.frame(khi2.df)
data.frame(khi2.df)
khi2.df
class(khi2.df)
as.data.frame(khi2.df)
khi2.df <- as.data.frame(khi2.df)
color.me <- which(khi2.df < .1)
color.me
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df <- as.data.frame(khi2.df)
color.me <- which(khi2.df < .1)
kable(khi2.df) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 24) %>%
column_spec(1, bold = TRUE) %>%
row_spec(color.me, bold = T, color = "white", background = "red")
kable(khi2.df) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 24) %>%
column_spec(1, bold = TRUE) %>%
row_spec(bold = T, color = "white", background = "red")
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"
khi2.df <- matrix(nrow = length(df$patient),
ncol = length(df$patient))
colnames(khi2.df) <- rownames(khi2.df) <- df$patient
khi2.df[1 , 2] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[2 , 1] <- round(chisq.test(df[, c(2, 3)])$p.value, 2)
khi2.df[1 , 3] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[3 , 1] <- round(chisq.test(df[, c(2, 4)])$p.value, 2)
khi2.df[2 , 3] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df[3 , 2] <- round(chisq.test(df[, c(3, 4)])$p.value, 2)
khi2.df <- as.data.frame(khi2.df)
color.me <- which(khi2.df < .1)
kable(khi2.df) %>%
kable_styling(full_width = FALSE, position = "center", font_size = 24) %>%
column_spec(1, bold = TRUE) %>%
row_spec(row = seq(1, nrow(khi2.df)), bold = T, color = "white", background = "red")
\
