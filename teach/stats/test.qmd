---
title: "TEST"
# subtitle: "Create beautiful interactive slide decks with Reveal.js"
author: "zoometh"
# margin-left: 5.4mm
# margin-right: 5.4mm
format:
  revealjs: 
    code-fold: true
    code-summary: "Show the code"
    slide-number: true
    chalkboard: true
    scrollable: true
    preview-links: auto
    reference-location: document
    footnotes-hover: true
    logo: images/inst-uni-oxford_.png
    css: https://zoometh.github.io/thomashuet/css/quarto.css
    footer: <https://tinyurl.com/goa-oxford>
    # margin: 0
    # width: 1400
---

```{r, echo=FALSE}
library(shiny)
library(rmarkdown)
library(plotly)
library(ggtern)
library(plotly)
library(DT)
library(dplyr)
library(archdata)
library(kableExtra)
library(FactoMineR)
library(archdata)
library(reshape2)
```

## Middle Range Theories 

<span class="midtext">Archaeology establishes *facts* and proposes **models** to connect these facts</span>

::: {.panel-tabset}

### MRT


<div class="row">

<div class="column33"><center>
![](https://raw.githubusercontent.com/zoometh/thomashuet/master/teach/stats/images/theo-archaeo-renfrewbahn.jpg){height=300px}
<div class="captiontext">Model of archaeological reasoning by Renfrew and Bahn, 2020</div>
</center></div>

<div class="column66"><center><span class= midtext>"Sociological theory, if it is to advance significantly, must proceed on these interconnected planes"[^5]</span><br><small> Robert K. Merton, 1968</small></center></div>

[^5]: "Sociological theory, if it is to advance significantly, must proceed on these interconnected planes: (1) by developing special theories from which to derive hypotheses that can be empirically investigated and (2) by evolving a progressively more general conceptual scheme that is adequate to consolidate groups of special theories" Robert K. Merton, 1968

</div>

### Example

<div class="row">
<div class="column"><center>![](https://raw.githubusercontent.com/zoometh/thomashuet/master/teach/stats/images/conformity-conformity-all.png){height=350px}</center></div>
<div class="column">We want to compare 3 different **archaeological cultures**[^6] (groups of settlements, sites, geographical regions, chronological periods, etc.): 
<span style="color:blue">A</span>, <span style="color:red">B</span>, and <span style="color:green">C</span>
</div>
</div>

[^6]: An archaeological culture is a polythetic assemblage of features more frequently associated with each other within a given area than outside it (Clarke 1968, Brun 1988, Shennan *et al.* 2015, etc.)

### Singularity

<div class="row">
<div class="column"><center>![](https://raw.githubusercontent.com/zoometh/thomashuet/master/teach/stats/images/conformity-conformity-all.png){height=350px}</center></div>
<div class="column">
<b>None</b> of the comparisons gives the same results<br>
<hr>
x &cap; &#937; = &empty;
<hr>
<div class= smalltext>‚ö†Ô∏è In practice, over-valuing a specific element by giving it a marker character is dangerous, as its originality makes its management uncontrollable.</div></div>
</div>

### Conformity

<div class="row">
<div class="column"><center>![](https://raw.githubusercontent.com/zoometh/thomashuet/master/teach/stats/images/conformity-conformity-all.png){height=350px}</center></div>
<div class="column">
<b>Some</b> comparisons give the same results<br>
<hr>
x &cap; &#937; = {1, 4, 12, ...}
<hr>
Ô∏è<div class= smalltext>üí° Increase the matching success of the model by decreasing its precision, or decrease the matching success of the model by increasing its precision.</div></div>
</div>

### Identity

<div class="row">

<div class="column">
![](https://raw.githubusercontent.com/zoometh/thomashuet/master/teach/stats/images/conformity-conformity-all.png){height=350px}</div>

<div class="column">
<b>All</b> the comparison give the same result<br>
<hr>
x &cap; &#937; = $&#937;
<hr>
Ô∏è<div class= smalltext>In practice, a common element in 3 or more different data sets is usually rare. </div></div>

</div>

:::


## My footnote


My footnote[^1]


[^1]: dewpeuoewufwefew


## Khi-square

&#967; <sup>2</sup>

* Observed numbers

```{r}
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"

library(dplyr)
library(tibble)

df <- data.frame(patient = c("Mal.1", "Mal.2", "Mal.3"),
                 virus.A = c(12, 18, 14),
                 virus.B = c(7, 7, 10),
                 virus.C = c(11, 5, 6))
kable(df) %>%
  kable_styling(full_width = FALSE, position = "center", font_size = 24)
```

* Calculation of rows and columns sums

```{r}
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"

df.copy <- df
df.copy <- rbind(df.copy, colSums(df.copy[ , -1]))
df.copy[nrow(df.copy), "patient"] <- "col.sum"
df.copy <- cbind(df.copy, rowSums(df.copy[ , -1]))
colnames(df.copy)[ncol(df.copy)] <- "row.sum"
kable(df.copy) %>%
  kable_styling(full_width = FALSE, position = "center", font_size = 24) %>%
  column_spec(ncol(df.copy), bold = TRUE) %>%
  row_spec(nrow(df.copy), bold = TRUE)
```

* Calculation of expected numbers (E)


```{r}
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"

chisq <- chisq.test(df[ , -1])
df.copy2 <- as.data.frame(round(chisq$expected, 2))
df.copy2$patient <- df$patient
kable(df.copy2) %>%
  kable_styling(full_width = FALSE, position = "center", font_size = 24)
```

* Differences between expected (E) and observed (O) numbers

```{r}
#| echo: true
#| code-fold: true
#| code-summary: "<small>Code</small>"

df.copy3 <- as.data.frame(round(chisq$residuals, 2))
df.copy3$patient <- df$patient
kable(df.copy3) %>%
  kable_styling(full_width = FALSE, position = "center", font_size = 24)
```


```{r}
#| code-fold: true
#| code-summary: "<small>Code</small>"

df.copy4 <- melt(df.copy3, id.vars = "patient")
ggplot(df.copy4, aes(x = variable, y = value,
                     colour = patient, 
                     group = patient)) + 
  geom_hline(yintercept = 0) +
  geom_point() +
  geom_text(aes(label = value), vjust = 1) +
  geom_path() +
  theme_bw()
```



* Khi-2 calculation

```{r}
#| echo: true
#| code-fold: true

df %>% 
  melt() %>%
  group_by(patient, variable) %>% 
  summarise(count = sum(value)) %>% 
  summarise(pvalue= chisq.test(count)$p.value)
```


H<sub>0</sub>: accept homogeneity hypothesis<br>
H<sub>1</sub>: reject homogeneity hypothesis

<div class="column">
![](https://raw.githubusercontent.com/zoometh/thomashuet/master/teach/stats/images/stat-pvalue.png){height=350px}
<div class="captiontext">*p-value* and *Z-score*, two normalised test thresholds to estimate the significance of an observed distribution *vs* a random distribution</div>
</div>

\


## background HTML

```{=html}
<iframe width="780" height="500" src="https://www.markdownguide.org/basic-syntax/" title="Markdown basic syntax"></iframe>
```

## Insert PDF


<img src="C:/Rprojects/thomashuet/teachings/stats/stats/z-references/fulford-hodder-74.pdf" alt="this is a PDF"  width="4200" height="4200">

<img src="C:/Rprojects/thomashuet/teachings/stats/stats/z-references/fulford-hodder-74.pdf" alt="this is a PDF"  width="4200" height="4200">


## COLO

:::{.column-body-outset}
Outset content...
:::

## More sspace

:::{.column-page}
![](images/dist-rand-ra-millestone.png)
:::

## dewpiwep

```{r}
#| column: screen
#| out-width: 150%
#| fig-format: svg
plot(pressure)
```


## GGGJGLJ

```{r}
#| column: page

knitr::kable(
  mtcars[1:6, 1:10]
)
```

## frwef

::: {.column-screen-inset}
![Full screen inset](images/dist-rand-ra-millestone.png)
:::

## A classer

For I. Herzog, there is a difference between validation and verification: validation of the model is when it is consistent with the facts (BIB I. Herzog, S28-09, CAA 2016). 


"In short, identifying the existence of discrete cultural groups is not trivial." 
(Shennan et al. 2015)

chefferie simple
chefferie complexe: sites principiers: En moyenne une distance d‚Äôune centaine de kilom√®tres entre chacune de ces r√©sidences

Test under the hypothesis H<sub>0</sub>. The *p-value* is the probability that H<sub>0</sub> is true, so the lower the *p-value*, the more likely H<sub>1</sub> is to exist<br>



# Language {.tabset .tabset-dropdown}

## English

<h1>English Title</h1>

Plot of random points

```{r, echo=FALSE}
plot(runif(10), runif(10), main = "Random points")
```

## French

<h1>Titre Fran√ßais</h1>

Trac√© de points al√©atoires

```{r, echo=FALSE}
plot(runif(10), runif(10), main = "Points al√©atoires")
```

## Code

When you click the **Render** button a presentation will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```
